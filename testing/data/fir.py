#!/usr/bin/env python3
from scipy.signal import lfilter
from numpy import zeros
import time

def load_signal(file_name = 'gse2.txt'):
    ifl = open(file_name, 'r')
    data = ifl.read()
    data = data.split('\n')
    signal = zeros(len(data) - 1)
    for i in range(len(signal)):
        signal[i] = float(data[i])
    return signal
    
if __name__ == "__main__":
    b = [-0.000000000000000, -0.001056235801065,  -0.000769341020163,
          0.000956323223723,  0.001976082742122,  -0.000000000000000,
         -0.003265384800345, -0.002568519852901,   0.003234633130890,
          0.006519908075213, -0.000000000000000,  -0.009825739114867,
         -0.007365685405410,  0.008881348924986,   0.017256056989442,
         -0.000000000000000, -0.024784271698734,  -0.018417666768131,
          0.022299534288278,  0.044222443880910,  -0.000000000000000,
         -0.071469809226860, -0.060430328816090,   0.092317626953209,
          0.302027315266443,  0.400523418058701,   0.302027315266443,
          0.092317626953209, -0.060430328816090,  -0.071469809226860,
         -0.000000000000000,  0.044222443880910,   0.022299534288278,
         -0.018417666768131, -0.024784271698734,  -0.000000000000000,
          0.017256056989442,  0.008881348924986,  -0.007365685405410,
         -0.009825739114867, -0.000000000000000,   0.006519908075213,
          0.003234633130890, -0.002568519852901,  -0.003265384800345,
         -0.000000000000000,  0.001976082742122,   0.000956323223723,
         -0.000769341020163, -0.001056235801065,  -0.000000000000000]
    a = [1]
    x = load_signal('gse2.txt')
    start = time.time_ns()
    y = lfilter(b, a, x)
    end = time.time_ns()
    print("Processing time {}".format( (end - start)*1.e-9 ))
    ofl = open('firReference.gse2.txt', 'w')
    for i in range(len(y)):
        ofl.write("{}\n".format(y[i]))
    ofl.close()
     
